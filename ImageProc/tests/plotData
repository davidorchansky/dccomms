set terminal pdf enhanced
set output outputfile

unset key
set style data histogram
set style histogram errorbars gap 1 lw 2
#set style fill solid 0.5 border 1
set auto x
set yrange [0<*:]
set ylabel "Time (us)"
set xlabel "Stage"
set xtics rotate by -45

set title font ",8"
set title (sprintf("Img: %s, Arch: %s, Schedule: %s, ChunkSize: %d,\nSigma: %.2f, T.Filtro: %d, U.Th: %d, L.Th: %d, Degrees: %d", imagen, arch, schedule, chunkSize, sigma, tfiltro, ut, lt, angles));
escalar(y) = y / 1000

set label (sprintf("TOTAL: %.1f ms", ttotal / 1000.)) at 6,(maxv*1.05) tc rgb "black" font ",14" front
#set label (sprintf("MAXV: %.1f ms", maxv / 1000.)) at 5,maxv*0.1 tc rgb "black" font ",14" front

plot inputfile using 2:3:xticlabels(1) lc rgb "#0000ff", \
'' using ($4):($2+maxv*0.1):(sprintf("%.1f ms",$2/1000)) with labels









#En lo siguiente, hay un FOR, pero no es necesario... ya que solo hay una barra por cluster (solo una iteracion)
#plot for [COL=2:2:1] inputfile using COL:COL+1:xticlabels(1) lc rgb "#0000ff", \
#'' using ($4):($2+$2*0.1):(sprintf("%.1f ms",$2/1000)) with labels


#plot for [COL=2:2:1] inputfile using COL:COL+1:xticlabels(1), \
#for [COL=4:4:1] inputfile using COL:COL+1:xticlabels(1), \
#'' using ($6-0.5):($2+4000):2 with labels

#plot for [COL=2:4:2] inputfile using COL:xticlabels(1) title "Etapa"
